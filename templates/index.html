{% extends "base.html" %}

{% block content %}
<div class="game-container">
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
    <div class="info-panel">
        <div class="user-info">
            <div class="balance">
                <i class="fas fa-wallet"></i>
                <span>–ë–∞–ª–∞–Ω—Å: <span id="user-balance">{{ "%.2f"|format(user.balance) }}</span> ‚ÇΩ</span>
            </div>
            <div class="username">
                <i class="fas fa-user"></i>
                <span>{{ user.username }}</span>
            </div>
        </div>
        <div class="game-timer">
            <div class="timer-circle">
                <div class="timer-text">
                    <span id="timer-value">25</span>
                    <span id="timer-label">—Å–µ–∫</span>
                </div>
            </div>
        </div>
    </div>

    <!-- –ò—Å—Ç–æ—Ä–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
    <div class="history-panel">
        <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
        <div class="history-numbers" id="history-numbers">
            {% for result in history %}
            <div class="history-number {{ result.color }}">{{ result.number }}</div>
            {% endfor %}
        </div>
    </div>

    <!-- –†—É–ª–µ—Ç–∫–∞ -->
    <div class="roulette-container">
        <div class="roulette-wheel" id="roulette-wheel">
            <div class="wheel-inner">
                {% for number in range(37) %}
                <div class="wheel-number {{ 'green' if number == 0 else ('red' if number in [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36] else 'black') }}" 
                     style="transform: rotate({{ (360 / 37) * number }}deg);">
                    <span>{{ number }}</span>
                </div>
                {% endfor %}
            </div>
            <div class="wheel-pointer"></div>
        </div>
        
        <div class="game-status" id="game-status">
            <div class="status-text">–î–µ–ª–∞–π—Ç–µ –≤–∞—à–∏ —Å—Ç–∞–≤–∫–∏!</div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞–≤–æ–∫ -->
    <div class="betting-panel">
        <div class="bet-amount-selector">
            <h4>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏</h4>
            <div class="amount-buttons">
                <button class="amount-btn" data-amount="10">10‚ÇΩ</button>
                <button class="amount-btn" data-amount="25">25‚ÇΩ</button>
                <button class="amount-btn" data-amount="50">50‚ÇΩ</button>
                <button class="amount-btn" data-amount="100">100‚ÇΩ</button>
                <button class="amount-btn" data-amount="250">250‚ÇΩ</button>
            </div>
            <div class="custom-amount">
                <input type="number" id="custom-amount" placeholder="–°–≤–æ—è —Å—É–º–º–∞" min="1" max="1000">
            </div>
        </div>

        <div class="betting-options">
            <div class="bet-option red" data-bet="red">
                <div class="bet-label">–ö–†–ê–°–ù–û–ï</div>
                <div class="bet-payout">x2</div>
                <div class="bet-total" id="red-total">0‚ÇΩ</div>
            </div>
            
            <div class="bet-option black" data-bet="black">
                <div class="bet-label">–ß–Å–†–ù–û–ï</div>
                <div class="bet-payout">x2</div>
                <div class="bet-total" id="black-total">0‚ÇΩ</div>
            </div>
            
            <div class="bet-option green" data-bet="green">
                <div class="bet-label">–ó–ï–õ–Å–ù–û–ï</div>
                <div class="bet-payout">x35</div>
                <div class="bet-total" id="green-total">0‚ÇΩ</div>
            </div>
        </div>
    </div>

    <!-- –≠—Ñ—Ñ–µ–∫—Ç—ã -->
    <div class="confetti" id="confetti"></div>
    <div class="win-overlay" id="win-overlay">
        <div class="win-message">
            <div class="win-icon">üéâ</div>
            <div class="win-text">–í–´–ò–ì–†–´–®!</div>
            <div class="win-amount" id="win-amount">+0‚ÇΩ</div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    const userId = {{ session.user_id }};
    const socket = io();
    
    let currentBetAmount = 10;
    let gameState = 'betting';
    let userBets = { red: 0, black: 0, green: 0 };
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', function() {
        initializeBetting();
        setupSocketListeners();
    });
</script>
{% endblock %}
